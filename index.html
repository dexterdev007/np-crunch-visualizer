<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NP-Completeness Visualizer | Interactive Reduction Demo</title>
    <meta name="description" content="Learn computational complexity through interactive visualizations. Explore SAT, 3-CNF, and Clique problem reductions with step-by-step animations.">
    <meta name="keywords" content="NP-Complete, SAT, 3-CNF, Clique, computational complexity, algorithm visualization, computer science education">
    
    <link rel="icon" href="/favicon.png" type="image/png">
    
    <!-- Cytoscape for graph visualization -->
    <script src="https://unpkg.com/cytoscape@3.33.1/dist/cytoscape.min.js"></script>
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --background: hsl(210, 40%, 98%);
            --foreground: hsl(222, 47%, 11%);
            --primary: hsl(217, 91%, 35%);
            --primary-foreground: hsl(0, 0%, 100%);
            --secondary: hsl(197, 71%, 48%);
            --secondary-foreground: hsl(0, 0%, 100%);
            --muted: hsl(210, 40%, 96%);
            --muted-foreground: hsl(215, 16%, 47%);
            --accent: hsl(27, 96%, 61%);
            --border: hsl(214, 32%, 91%);
            --card: hsl(0, 0%, 100%);
            --card-foreground: hsl(222, 47%, 11%);
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            background: var(--background);
            color: var(--foreground);
            line-height: 1.5;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 2rem 1rem;
        }

        /* Hero Section */
        .hero {
            background: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%);
            color: white;
            padding: 4rem 2rem;
            text-align: center;
            border-radius: 1rem;
            margin-bottom: 2rem;
        }

        .hero-logo {
            width: 120px;
            height: 120px;
            margin: 0 auto 1.5rem;
        }

        .hero h1 {
            font-size: 2.5rem;
            margin-bottom: 1rem;
            font-weight: 700;
        }

        .hero p {
            font-size: 1.25rem;
            opacity: 0.95;
            margin-bottom: 2rem;
        }

        .info-cards {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1rem;
            margin-top: 2rem;
        }

        .info-card {
            background: rgba(255, 255, 255, 0.1);
            padding: 1.5rem;
            border-radius: 0.75rem;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .info-card h3 {
            font-size: 1.25rem;
            margin-bottom: 0.5rem;
        }

        /* Input Section */
        .input-section {
            background: var(--card);
            border-radius: 0.75rem;
            padding: 2rem;
            box-shadow: 0 4px 20px -4px rgba(0, 0, 0, 0.1);
            margin-bottom: 2rem;
        }

        .input-section h2 {
            font-size: 1.5rem;
            margin-bottom: 1rem;
            color: var(--foreground);
        }

        input[type="text"] {
            width: 100%;
            padding: 0.75rem 1rem;
            border: 2px solid var(--border);
            border-radius: 0.5rem;
            font-size: 1rem;
            margin-bottom: 1rem;
            transition: border-color 0.2s;
        }

        input[type="text"]:focus {
            outline: none;
            border-color: var(--primary);
        }

        button {
            background: var(--primary);
            color: white;
            padding: 0.75rem 2rem;
            border: none;
            border-radius: 0.5rem;
            font-size: 1rem;
            cursor: pointer;
            transition: opacity 0.2s;
        }

        button:hover {
            opacity: 0.9;
        }

        button:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .button-secondary {
            background: var(--muted);
            color: var(--foreground);
            padding: 0.5rem 1rem;
            margin: 0.25rem;
            font-size: 0.875rem;
        }

        .examples {
            margin-top: 1rem;
        }

        .examples p {
            color: var(--muted-foreground);
            margin-bottom: 0.5rem;
            font-size: 0.875rem;
        }

        .syntax-guide {
            background: var(--muted);
            padding: 1rem;
            border-radius: 0.5rem;
            margin-top: 1rem;
            font-size: 0.875rem;
        }

        /* Visualization Section */
        .viz-section {
            display: none;
        }

        .viz-section.active {
            display: block;
        }

        .step-indicators {
            display: flex;
            justify-content: center;
            gap: 1rem;
            margin-bottom: 2rem;
        }

        .step-indicator {
            width: 3rem;
            height: 3rem;
            border-radius: 50%;
            background: var(--muted);
            color: var(--muted-foreground);
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 600;
            position: relative;
        }

        .step-indicator.active {
            background: var(--primary);
            color: white;
        }

        .step-indicator.completed {
            background: var(--secondary);
            color: white;
        }

        .step-card {
            background: var(--card);
            border-radius: 0.75rem;
            padding: 2rem;
            box-shadow: 0 4px 20px -4px rgba(0, 0, 0, 0.1);
            margin-bottom: 2rem;
            display: none;
        }

        .step-card.active {
            display: block;
            animation: slideIn 0.3s ease-out;
        }

        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateX(20px);
            }
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }

        .step-header {
            display: flex;
            gap: 1rem;
            margin-bottom: 1.5rem;
            align-items: start;
        }

        .step-icon {
            width: 3rem;
            height: 3rem;
            background: rgba(var(--primary), 0.1);
            border-radius: 0.5rem;
            display: flex;
            align-items: center;
            justify-content: center;
            flex-shrink: 0;
        }

        .step-title h3 {
            font-size: 1.5rem;
            margin-bottom: 0.5rem;
        }

        .formula-display {
            background: linear-gradient(180deg, var(--card) 0%, var(--muted) 100%);
            border: 2px solid rgba(var(--primary), 0.2);
            border-radius: 0.75rem;
            padding: 2rem;
            text-align: center;
            margin: 1rem 0;
        }

        .formula-text {
            font-size: 2rem;
            font-family: 'Courier New', monospace;
            font-weight: 700;
            color: var(--primary);
        }

        .clause-list {
            display: flex;
            flex-wrap: wrap;
            gap: 0.75rem;
            margin: 1rem 0;
        }

        .clause {
            background: var(--muted);
            padding: 0.75rem 1rem;
            border-radius: 0.5rem;
            border: 2px solid var(--border);
            font-family: 'Courier New', monospace;
            font-weight: 600;
        }

        #cy {
            width: 100%;
            height: 500px;
            border: 2px solid var(--border);
            border-radius: 0.75rem;
            margin: 1rem 0;
        }

        .info-box {
            background: rgba(var(--muted), 0.5);
            padding: 1rem;
            border-radius: 0.5rem;
            margin-top: 1rem;
        }

        .info-box h4 {
            font-weight: 600;
            margin-bottom: 0.5rem;
        }

        .info-box p {
            font-size: 0.875rem;
            color: var(--muted-foreground);
        }

        .controls {
            display: flex;
            gap: 1rem;
            justify-content: center;
            margin-top: 2rem;
        }

        .back-button {
            background: var(--muted);
            color: var(--foreground);
        }

        .hidden {
            display: none;
        }

        .toast {
            position: fixed;
            bottom: 2rem;
            right: 2rem;
            background: var(--card);
            padding: 1rem 1.5rem;
            border-radius: 0.5rem;
            box-shadow: 0 10px 40px -10px rgba(0, 0, 0, 0.3);
            transform: translateX(400px);
            transition: transform 0.3s ease-out;
            z-index: 1000;
            border-left: 4px solid var(--primary);
        }

        .toast.show {
            transform: translateX(0);
        }

        .toast.error {
            border-left-color: hsl(0, 84%, 60%);
        }
    </style>
</head>
<body>
    <div id="app">
        <!-- Hero Section -->
        <div class="hero">
            <img src="/src/assets/logo.png" alt="NP-Completeness Visualizer" class="hero-logo" onerror="this.style.display='none'">
            <h1>NP-Completeness Visualizer</h1>
            <p>Learn computational complexity through interactive step-by-step visualizations</p>
            
            <div class="info-cards">
                <div class="info-card">
                    <h3>üìñ SAT Problem</h3>
                    <p>Start with a Boolean satisfiability formula</p>
                </div>
                <div class="info-card">
                    <h3>üß† 3-CNF Conversion</h3>
                    <p>Transform into 3-Conjunctive Normal Form</p>
                </div>
                <div class="info-card">
                    <h3>üîó Clique Problem</h3>
                    <p>Visualize the reduction to finding cliques</p>
                </div>
            </div>
        </div>

        <div class="container">
            <!-- Input Section -->
            <div id="input-section" class="input-section">
                <h2>Enter Your SAT Formula</h2>
                <p style="color: var(--muted-foreground); margin-bottom: 1rem;">
                    Enter a Boolean satisfiability formula to visualize its reduction to the Clique problem
                </p>
                
                <form id="formula-form">
                    <input 
                        type="text" 
                        id="formula-input" 
                        placeholder="e.g., (A ‚à® B ‚à® C) ‚àß (¬¨A ‚à® D ‚à® E) ‚àß (¬¨B ‚à® ¬¨C ‚à® F)"
                        required
                    >
                    <button type="submit" id="submit-btn">Visualize Reduction</button>
                </form>

                <div class="syntax-guide">
                    <strong>Syntax Guide:</strong><br>
                    ‚Ä¢ Use ‚àß (AND), ‚à® (OR), ¬¨ (NOT)<br>
                    ‚Ä¢ Variables: Single letters (A, B, C, etc.)<br>
                    ‚Ä¢ Format: (A ‚à® B ‚à® C) ‚àß (D ‚à® E ‚à® F)
                </div>

                <div class="examples">
                    <p><strong>Try these examples:</strong></p>
                    <button type="button" class="button-secondary" onclick="setExample('(A ‚à® B ‚à® C) ‚àß (¬¨A ‚à® D ‚à® E) ‚àß (¬¨B ‚à® ¬¨C ‚à® F)')">
                        Example 1
                    </button>
                    <button type="button" class="button-secondary" onclick="setExample('(X ‚à® Y ‚à® Z) ‚àß (¬¨X ‚à® ¬¨Y ‚à® W) ‚àß (¬¨Z ‚à® W ‚à® X)')">
                        Example 2
                    </button>
                    <button type="button" class="button-secondary" onclick="setExample('(P ‚à® Q ‚à® R) ‚àß (¬¨P ‚à® S ‚à® T) ‚àß (¬¨Q ‚à® ¬¨R ‚à® U)')">
                        Example 3
                    </button>
                </div>
            </div>

            <!-- Visualization Section -->
            <div id="viz-section" class="viz-section">
                <button class="back-button" onclick="goBack()">‚Üê Back to Input</button>
                
                <div class="step-indicators" id="step-indicators">
                    <div class="step-indicator active" data-step="0">1</div>
                    <div class="step-indicator" data-step="1">2</div>
                    <div class="step-indicator" data-step="2">3</div>
                </div>

                <!-- Step 1: SAT -->
                <div id="step-0" class="step-card active">
                    <div class="step-header">
                        <div class="step-icon">üìñ</div>
                        <div class="step-title">
                            <h3>SAT Formula</h3>
                            <p style="color: var(--muted-foreground)">Original Boolean satisfiability problem</p>
                        </div>
                    </div>
                    <div class="formula-display">
                        <p style="color: var(--muted-foreground); margin-bottom: 0.5rem; font-size: 0.875rem;">Boolean Formula</p>
                        <div class="formula-text" id="sat-formula"></div>
                    </div>
                    <div class="info-box">
                        <h4>What is SAT?</h4>
                        <p>The Boolean Satisfiability Problem (SAT) asks whether there exists an assignment of truth values to variables that makes the entire formula true. SAT was the first problem proven to be NP-complete.</p>
                    </div>
                </div>

                <!-- Step 2: 3-CNF -->
                <div id="step-1" class="step-card">
                    <div class="step-header">
                        <div class="step-icon">üß†</div>
                        <div class="step-title">
                            <h3>3-CNF Conversion</h3>
                            <p style="color: var(--muted-foreground)">Formula converted to 3-Conjunctive Normal Form</p>
                        </div>
                    </div>
                    <div class="formula-display">
                        <p style="color: var(--muted-foreground); margin-bottom: 0.5rem; font-size: 0.875rem;">3-CNF Clauses</p>
                        <div class="clause-list" id="cnf-clauses"></div>
                    </div>
                    <div class="info-box">
                        <h4>What is 3-CNF?</h4>
                        <p>3-Conjunctive Normal Form requires the formula to be expressed as a conjunction (AND) of clauses, where each clause contains exactly three literals connected by disjunction (OR).</p>
                    </div>
                </div>

                <!-- Step 3: Clique -->
                <div id="step-2" class="step-card">
                    <div class="step-header">
                        <div class="step-icon">üîó</div>
                        <div class="step-title">
                            <h3>Clique Graph</h3>
                            <p style="color: var(--muted-foreground)">Graph representation of the problem</p>
                        </div>
                    </div>
                    <div id="cy"></div>
                    <div class="info-box">
                        <h4>Understanding the Graph</h4>
                        <p><strong>Nodes:</strong> Each node represents a literal from a clause.<br>
                        <strong>Edges:</strong> Connect literals from different clauses that don't contradict each other.<br>
                        <strong>Goal:</strong> Find a clique of size k (number of clauses) to satisfy the formula.</p>
                    </div>
                </div>

                <div class="controls">
                    <button id="prev-btn" onclick="prevStep()" class="back-button">Previous</button>
                    <button id="next-btn" onclick="nextStep()">Next Step</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Toast notification -->
    <div id="toast" class="toast"></div>

    <script>
        // State
        let currentStep = 0;
        let reductionData = null;
        let cyInstance = null;

        // Toast notifications
        function showToast(message, isError = false) {
            const toast = document.getElementById('toast');
            toast.textContent = message;
            toast.className = 'toast show' + (isError ? ' error' : '');
            setTimeout(() => {
                toast.className = 'toast';
            }, 3000);
        }

        // Example buttons
        function setExample(formula) {
            document.getElementById('formula-input').value = formula;
        }

        // SAT Reduction Logic
        function processFormula(formula) {
            try {
                // Convert to 3-CNF
                const cnf3 = convertTo3CNF(formula);
                
                // Build clique graph
                const clique = buildCliqueGraph(cnf3.clauses);
                
                return {
                    sat: {
                        formula: formula,
                        explanation: "Original Boolean satisfiability problem"
                    },
                    cnf3: cnf3,
                    clique: clique
                };
            } catch (error) {
                throw new Error('Failed to process formula: ' + error.message);
            }
        }

        function convertTo3CNF(formula) {
            // Remove whitespace
            formula = formula.replace(/\s+/g, '');
            
            // Split by AND (‚àß)
            const clauseStrings = formula.split('‚àß');
            const clauses = [];
            
            for (let clauseStr of clauseStrings) {
                // Remove parentheses
                clauseStr = clauseStr.replace(/[()]/g, '');
                
                // Split by OR (‚à®)
                let literals = clauseStr.split('‚à®').map(l => l.trim());
                
                // Ensure exactly 3 literals
                while (literals.length < 3) {
                    literals.push(literals[literals.length - 1]);
                }
                if (literals.length > 3) {
                    literals = literals.slice(0, 3);
                }
                
                clauses.push(literals);
            }
            
            return {
                clauses: clauses,
                explanation: "Formula converted to 3-Conjunctive Normal Form"
            };
        }

        function buildCliqueGraph(clauses) {
            const nodes = [];
            const edges = [];
            let nodeId = 0;
            
            // Create nodes for each literal in each clause
            clauses.forEach((clause, clauseIndex) => {
                clause.forEach(literal => {
                    nodes.push({
                        id: `node-${nodeId}`,
                        label: literal,
                        clause: clauseIndex
                    });
                    nodeId++;
                });
            });
            
            // Create edges between compatible nodes
            for (let i = 0; i < nodes.length; i++) {
                for (let j = i + 1; j < nodes.length; j++) {
                    const node1 = nodes[i];
                    const node2 = nodes[j];
                    
                    // Only connect nodes from different clauses
                    if (node1.clause !== node2.clause) {
                        // Check if literals are not contradictory
                        if (!areContradictory(node1.label, node2.label)) {
                            edges.push({
                                source: node1.id,
                                target: node2.id
                            });
                        }
                    }
                }
            }
            
            return {
                nodes: nodes,
                edges: edges,
                explanation: "Graph where nodes are literals and edges connect compatible literals"
            };
        }

        function areContradictory(literal1, literal2) {
            // Check if one is the negation of the other
            const neg1 = literal1.startsWith('¬¨') ? literal1.substring(1) : '¬¨' + literal1;
            return neg1 === literal2;
        }

        // Form submission
        document.getElementById('formula-form').addEventListener('submit', function(e) {
            e.preventDefault();
            const formula = document.getElementById('formula-input').value.trim();
            
            if (!formula) {
                showToast('Please enter a formula', true);
                return;
            }
            
            try {
                reductionData = processFormula(formula);
                showVisualization();
                showToast('Formula processed successfully!');
            } catch (error) {
                showToast(error.message, true);
            }
        });

        function showVisualization() {
            document.getElementById('input-section').classList.add('hidden');
            document.getElementById('viz-section').classList.add('active');
            currentStep = 0;
            renderStep();
        }

        function goBack() {
            document.getElementById('viz-section').classList.remove('active');
            document.getElementById('input-section').classList.remove('hidden');
            if (cyInstance) {
                cyInstance.destroy();
                cyInstance = null;
            }
        }

        function nextStep() {
            if (currentStep < 2) {
                currentStep++;
                renderStep();
            }
        }

        function prevStep() {
            if (currentStep > 0) {
                currentStep--;
                renderStep();
            }
        }

        function renderStep() {
            // Update indicators
            document.querySelectorAll('.step-indicator').forEach((indicator, index) => {
                indicator.className = 'step-indicator';
                if (index < currentStep) {
                    indicator.classList.add('completed');
                } else if (index === currentStep) {
                    indicator.classList.add('active');
                }
            });

            // Update step cards
            document.querySelectorAll('.step-card').forEach((card, index) => {
                card.className = 'step-card';
                if (index === currentStep) {
                    card.classList.add('active');
                }
            });

            // Update button states
            document.getElementById('prev-btn').disabled = currentStep === 0;
            document.getElementById('next-btn').disabled = currentStep === 2;

            // Render content based on step
            if (currentStep === 0) {
                document.getElementById('sat-formula').textContent = reductionData.sat.formula;
            } else if (currentStep === 1) {
                const clausesContainer = document.getElementById('cnf-clauses');
                clausesContainer.innerHTML = '';
                reductionData.cnf3.clauses.forEach((clause, index) => {
                    const clauseDiv = document.createElement('div');
                    clauseDiv.className = 'clause';
                    clauseDiv.textContent = `C${index + 1}: (${clause.join(' ‚à® ')})`;
                    clausesContainer.appendChild(clauseDiv);
                });
            } else if (currentStep === 2) {
                renderGraph();
            }
        }

        function renderGraph() {
            if (cyInstance) {
                cyInstance.destroy();
            }

            const elements = [];
            
            // Add nodes
            reductionData.clique.nodes.forEach(node => {
                elements.push({
                    data: { 
                        id: node.id, 
                        label: node.label,
                        clause: node.clause
                    }
                });
            });
            
            // Add edges
            reductionData.clique.edges.forEach(edge => {
                elements.push({
                    data: { 
                        source: edge.source, 
                        target: edge.target 
                    }
                });
            });

            cyInstance = cytoscape({
                container: document.getElementById('cy'),
                elements: elements,
                style: [
                    {
                        selector: 'node',
                        style: {
                            'background-color': 'hsl(217, 91%, 35%)',
                            'label': 'data(label)',
                            'color': '#fff',
                            'text-valign': 'center',
                            'text-halign': 'center',
                            'font-size': '14px',
                            'font-weight': 'bold',
                            'width': 40,
                            'height': 40
                        }
                    },
                    {
                        selector: 'edge',
                        style: {
                            'width': 2,
                            'line-color': 'hsl(197, 71%, 48%)',
                            'curve-style': 'bezier'
                        }
                    },
                    {
                        selector: 'node.highlighted',
                        style: {
                            'background-color': 'hsl(27, 96%, 61%)',
                            'border-width': 3,
                            'border-color': 'hsl(27, 96%, 71%)'
                        }
                    },
                    {
                        selector: 'edge.highlighted',
                        style: {
                            'line-color': 'hsl(27, 96%, 61%)',
                            'width': 4
                        }
                    }
                ],
                layout: {
                    name: 'circle',
                    padding: 50
                }
            });

            // Add click interaction
            cyInstance.on('tap', 'node', function(evt) {
                const node = evt.target;
                cyInstance.elements().removeClass('highlighted');
                node.addClass('highlighted');
                node.connectedEdges().addClass('highlighted');
                node.neighborhood('node').addClass('highlighted');
            });
        }
    </script>
</body>
</html>